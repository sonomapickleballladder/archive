function jsonify(){let e={},t=document.querySelector("form").querySelectorAll(".wrap");for(let r=0;r<t.length;r++){let l=t[r].querySelectorAll("input");if(l.length>1){let t=null,r=l[0].getAttribute("c");for(let e=0;e<l.length;e++){let r=l[e];if(r.getAttribute("c")){r.getAttribute("c");"checkbox"==r.type?r.checked&&(null==t&&(t=[]),t.push(r.value)):"radio"==r.type?r.checked&&(t=r.value):r.value&&(t=r.value)}}null!=t&&(e[r]=t)}else{let t=l[0];if(t.getAttribute("c")){let r=t.getAttribute("c");"checkbox"==t.type?t.checked?e[r]=t.value:e[r]=t.checked:"radio"==t.type?t.checked&&(e[r]=t.value):t.value&&(e[r]=t.value)}}r==t.length-1&&validate(e)}}let count1=0;function validate(e){const t={first_name:0,last_name:0,email:0,secret_key:0,prefer:0,have_read:0,ladder:0,payment_method:0,rating_type:0},r=["phone"];let l=document.querySelectorAll("input[c]");for(let a=0;a<l.length;a++){if(l[a].closest(".wrap").classList.contains("h")||0!=r.includes(l[a].getAttribute("c"))||(t[l[a].getAttribute("c")]=0),a==l.length-1){let r=Object.keys(e),l=Object.keys(t),a=0;for(let t=l.length-1;t>-1;t--){if(!r.includes(l[t])){a++;let e=document.querySelectorAll(`[c=${l[t]}]`);for(let t=0;t<e.length;t++){let r=e[t].closest(".wrap");e[t].placeholder;r.classList.add("awaiting"),e[t].placeholder="Required",e[t].addEventListener("input",(()=>{r.classList.remove("awaiting"),e[t].getAttribute("dplaceholder")?e[t].placeholder=e[t].getAttribute("dplaceholder"):e[t].placeholder=""})),e[t].focus()}}if(0==t){let e=byId("int_confirm_yes"),t=e.closest(".wrap");if(!t.classList.contains("h")&&!e.checked)return t.classList.add("awaiting"),e.focus(),!1;t.classList.remove("awaiting")}if(0==t&&a<1){try{delete e.rating_type}catch(e){}try{e.first_name=e.first_name.proper(1)}catch(e){}try{e.last_name=e.last_name.proper(1)}catch(e){}try{e.email=e.email.toLowerCase()}catch(e){}try{e.username=(e.first_name+e.last_name).replace(/\s/g,"").toLowerCase()}catch(e){}try{document.querySelector("input[c=fallback_ladder]").closest(".wrap").classList.contains("h")&&delete e.fallback_ladder}catch(e){}if(!document.querySelector("form").checkValidity())return!1;if(!confirm("Do you wish to proceed? You will not be able to go back and edit your responses once submitted."))return unpulse(),!1;try{if(count1>2)return alert("Too many requests"),!1}catch(e){}try{saveFormInput()}catch(e){}document.body.classList.add("pulse"),byId("submit_signup").disabled=!0,register(e).then((function(t){try{count1+=1}catch(e){}try{var r=document.querySelector('meta[name="viewport"]');r&&r.setAttribute("content","width=device-width, maximum-scale=1.0, initial-scale=1.0"),byId("submit_signup").blur()}catch(e){}t.error?(unpulse(),alert("Registration failed. Please make sure you have provided a valid email address, and a password that is at least 6 characters long.")):saveData("Signups",e).then((function(e){unpulse(),e.error?(document.write(`<pre class="abs-center" style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); font-size: larger; word-wrap: break-word; white-space: pre-wrap;">An error occurred. Click <a href='mailto:SPLwebsitebugs@riseup.net?subject=Bug Report&body=${sendBug(e.error)}'>here</a> to submit a bug report.</pre>`),document.title="Error"):(localStorage.setItem(brick("$_hasRegistered"+ladderSeason),!0),document.write('<pre class="abs-center" style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); font-size: larger; word-wrap: break-word; white-space: pre-wrap;">Successfully submitted. You should receive a link to confirm your email address shortly. Please check both your inbox and spam folders.</pre>'),document.title="Success")}))}))}}}}}function toggleFallback(e){try{let t=e.getAttribute("c"),r=document.querySelectorAll(`input[c=${t}]`),l={yes:[],maybe:[]};for(let e=0;e<r.length;e++)if(r[e].nextElementSibling.innerHTML.indexOf("*")>-1?l.maybe.push(r[e].checked):l.yes.push(r[e].checked),e==r.length-1){let e={wrap:"fallback_field",for:"fallback_ladder"};!l.yes.includes(!0)&&l.maybe.includes(!0)?(byId(e.wrap).classList.remove("h"),document.querySelector(`input[c=${e.for}]`).focus()):byId(e.wrap).classList.add("h")}}catch(e){}}function toggleIntConfirm(e){try{let t=e.getAttribute("c"),r=document.querySelectorAll(`input[c=${t}]`),l={yes:[],maybe:[]};for(let e=0;e<r.length;e++)if(r[e].nextElementSibling.innerHTML.indexOf("*")>-1?l.maybe.push(r[e].checked):l.yes.push(r[e].checked),e==r.length-1){let e={wrap:"confirm_intention_field",for:"int_confirm_yes"};l.maybe.includes(!0)?(byId(e.wrap).classList.remove("h"),document.querySelector(`input[id=${e.for}]`).focus()):byId(e.wrap).classList.add("h")}}catch(e){}}function toggleFields(e,t){try{let r=document.querySelectorAll(`[name=${e.name}]`);for(let e=0;e<r.length;e++)try{let l;l=t?t.split("/"):r[e].getAttribute("toggle").split("/"),l={wrap:l[0],for:l[1]},r[e].checked?(byId(l.wrap).classList.remove("h"),document.querySelector(`input[c=${l.for}]`).focus()):byId(l.wrap).classList.add("h")}catch(e){}}catch(e){}}function unpulse(){try{document.body.classList.remove("pulse"),byId("submit_signup").disabled=!1}catch(e){}}function saveFormInput(){try{if(location.href.indexOf("&save=no")<0||location.href.indexOf("?save=no")<0){let e=document.querySelectorAll("input[c]"),t={};for(let r=0;r<e.length;r++){let l=e[r].getAttribute("c");if("radio"==e[r].type)e[r].checked&&(t[l]=[...e[r].closest(".wrap").querySelectorAll(`input[c=${l}]`)].indexOf(e[r]));else if("checkbox"==e[r].type){let a=document.querySelectorAll(`input[c=${e[r].getAttribute("c")}]`),c=Array.from(a,(e=>e.checked));t[l]=c}else t[l]=e[r].value;r==e.length-1&&location.hash.indexOf("view-responses")<0&&(t=JSON.stringify(t),localStorage.setItem(brick("$_signupFormInput"+ladderSeason),lsciph(t)))}}}catch(e){}}function ischeckable(e){try{return"radio"==e.type||"checkbox"==e.type}catch(e){return!1}}async function register(e){document.createElement("a").href="authorize.html";const{data:t,error:r}=await sb.client.auth.signUp({email:e.email,password:e.secret_key,options:{data:e}});return{data:t,error:r}}window.onload=()=>{try{document.querySelector("input[c]").focus()}catch(e){}try{if(/^((?!chrome|android).)*safari/i.test(navigator.userAgent)){let e=document.querySelectorAll('input[type="checkbox"],input[type="radio"]');for(let t=0;t<e.length;t++)e[t].classList.add("safari-input")}}catch(e){}try{let e=localStorage.getItem(brick("$_hasRegistered"+ladderSeason)),t=(lsdciph(localStorage.getItem(brick("$_authenticated_user"+ladderSeason))),lsdciph(localStorage.getItem(brick("$_signupFormInput"+ladderSeason))));if(e)if(location.hash.indexOf("view-responses")<0&&location.href.indexOf("invite=")<0)document.write('<pre class="abs-center" style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); font-size: larger; word-wrap: break-word; white-space: pre-wrap;">You have already signed up. Click <a href="?reload=1#view-responses">here</a> to view your responses.</pre>');else if(location.href.indexOf("invite=")<0){t||document.write('<pre class="abs-center" style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); font-size: larger; word-wrap: break-word; white-space: pre-wrap;">Something went wrong ☹️</pre>');let e=document.querySelectorAll("input"),r=document.querySelector("input[type=submit]");r.parentNode.removeChild(r);for(let t=0;t<e.length;t++)e[t].setAttribute("disabled","true")}}catch(e){}try{let e=lsdciph(localStorage.getItem(brick("$_signupFormInput"+ladderSeason))),t=Object.keys(e);for(let r=0;r<t.length;r++){let l=e[t[r]],a=document.querySelector(`input[c=${t[r]}]`);if("radio"==a.type)"number"==typeof l&&([...a.closest(".wrap").querySelectorAll(`input[c=${t[r]}]`)][l].checked="true");else if("checkbox"==a.type){let e=document.querySelectorAll(`input[c=${t[r]}]`);for(let a=0;a<e.length;a++){let c=[...e[a].closest(".wrap").querySelectorAll(`input[c=${t[r]}]`)].indexOf(e[a]);c>-1&&1==l[c]&&(e[a].checked=!0)}}else a.value=l}}catch(e){}setTimeout((function(){let e=document.querySelectorAll("input[toggle]");for(let t=0;t<e.length;t++)e[t].checked&&toggleFields(e[t])}),10),setTimeout((function(){toggleFallback(document.querySelector("input[c=ladder]"))}),10),setTimeout((function(){toggleIntConfirm(document.querySelector("input[c=ladder]"))}),10);try{let e=document.querySelectorAll("input");for(let t=0;t<e.length;t++)e[t].addEventListener("blur",(function(){var e=document.querySelector('meta[name="viewport"]');e&&e.setAttribute("content","width=device-width, maximum-scale=1.0, initial-scale=1.0")})),e[t].addEventListener("focus",(function(){var e=document.querySelector('meta[name="viewport"]');e&&e.setAttribute("content","width=device-width, maximum-scale=1.0, initial-scale=1.0")}))}catch(e){}},window.onbeforeunload=function(){return"Are you sure you want to leave. Changes may not be saved?"},window.onunload=function(){saveFormInput()},window.addEventListener("keydown",(e=>{}));