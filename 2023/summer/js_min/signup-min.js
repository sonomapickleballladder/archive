function jsonify(){let e={},t=document.querySelector("form").querySelectorAll(".wrap");for(let r=0;r<t.length;r++){let n=t[r].querySelectorAll("input");if(n.length>1){let t=null,r=n[0].getAttribute("c");for(let e=0;e<n.length;e++){let r=n[e];if(r.getAttribute("c")){r.getAttribute("c");"checkbox"==r.type?r.checked&&(null==t&&(t=[]),t.push(r.value)):"radio"==r.type?r.checked&&(t=r.value):r.value.trim()&&(t=r.value.trim())}}null!=t&&(e[r]=t)}else{let t=n[0];if(t.getAttribute("c")){let r=t.getAttribute("c");"checkbox"==t.type?t.checked?e[r]=t.value:e[r]=t.checked:"radio"==t.type?t.checked&&(e[r]=t.value):t.value.trim()&&(e[r]=t.value.trim())}}r==t.length-1&&validate(e)}}let count1=0;function validate(e){const t={first_name:0,last_name:0,email:0,secret_key:0,prefer:0,have_read:0,ladder:0,payment_method:0,rating_type:0},r=["phone"];let n=document.querySelectorAll("input[c]");for(let a=0;a<n.length;a++){if(n[a].closest(".wrap").classList.contains("h")||0!=r.includes(n[a].getAttribute("c"))||(t[n[a].getAttribute("c")]=0),a==n.length-1){let r=Object.keys(e),n=Object.keys(t),a=0;for(let t=n.length-1;t>-1;t--){if(!r.includes(n[t])){a++;let e=document.querySelectorAll(`[c=${n[t]}]`);for(let t=0;t<e.length;t++){let r=e[t].closest(".wrap");e[t].placeholder;r.classList.add("awaiting"),e[t].placeholder="Required",e[t].addEventListener("input",(()=>{r.classList.remove("awaiting"),e[t].getAttribute("dplaceholder")?e[t].placeholder=e[t].getAttribute("dplaceholder"):e[t].placeholder=""})),e[t].focus()}}if(0==t){let e=byId("int_confirm_yes"),t=e.closest(".wrap");if(!t.classList.contains("h")&&!e.checked)return t.classList.add("awaiting"),e.focus(),!1;t.classList.remove("awaiting")}if(0==t&&a<1){try{delete e.rating_type}catch(e){}try{e.first_name=e.first_name.proper(1)}catch(e){}try{e.last_name=e.last_name.proper(1)}catch(e){}try{byId("display_name").value.trim()?e.display_name=byId("display_name").value.trim():e.display_name=`${e.first_name} ${e.last_name}`}catch(e){}try{e.email=e.email.toLowerCase()}catch(e){}try{e.emailx=emailx(e.email)}catch(e){}try{e.username=(e.first_name+e.last_name).replace(/\s/g,"").toLowerCase()}catch(e){}try{document.querySelector("input[c=fallback_ladder]").closest(".wrap").classList.contains("h")&&delete e.fallback_ladder}catch(e){}try{e.darktheme=[...document.body.classList].indexOf("dark_theme")>-1}catch(e){}try{if(e.partner_name){let t=[];t.push(e.display_name),t.push(e.partner_name),t=t.sort(((e,t)=>e.localeCompare(t))).join(" & "),e.team_name=t}}catch(e){}if(!document.querySelector("form").checkValidity())return!1;if(!confirm("Do you wish to proceed? You will not be able to go back and edit your responses once submitted (although you can ask me [the administrator] to change them)."))return unpulse(),!1;try{if(count1>2)return alert("Too many requests"),!1}catch(e){}try{saveFormInput()}catch(e){}document.body.classList.add("pulse"),byId("submit_signup").disabled=!0,register(e).then((function(t){try{count1+=1}catch(e){}try{var r=document.querySelector('meta[name="viewport"]');r&&r.setAttribute("content","width=device-width, maximum-scale=1.0, initial-scale=1.0"),byId("submit_signup").blur()}catch(e){}if(t.error)unpulse(),alert("Registration failed. Please make sure you have provided a valid email address, and a password that is at least 6 characters long.");else{try{e.secret_key=LZString.compressToBase64(e.secret_key)}catch(e){}saveData("Signups",e).then((function(t){for(let t=0;t<e.ladder.length;t++){let r=e.ladder[t];try{let t=e.display_name;byId("vbconsent").checked||(t="anonymous");let n={name:t,full_name:`${e.first_name} ${e.last_name}`,ladder:r,nameladder:`${e.username},${r}`,rating:`${e.DUPR}`,partner_name:e.partner_name,team_name:e.team_name};saveData("viewable_Signups",n)}catch(e){}}if(unpulse(),t.error)document.body.innerHTML=`An error occurred. This may be the result of you trying to sign up twice, or you may have used a name or email address which was already taken. Click <a href='mailto:SPLwebsitebugs@riseup.net?subject=Bug Report&body=${sendBug(t.error)}'>here</a> to submit a bug report.`,document.title="Error";else{try{snEm({email:["SPLinfo+newsignup@riseup.net"],subject:"New Signup",bod:`Hi there,%0AJust wanted to let you know that ${e.first_name} ${e.last_name} just signed up for ${e.ladder}%0AHave a nice day!%0ABot`})}catch(e){}localStorage.setItem(brick("$_hasRegistered"+ladderSeason),!0),document.body.innerHTML="Successfully submitted! You should receive a link to confirm your email address shortly. Please check both your inbox and spam folders. Once you have confirmed your email, you are all set for now. I will send out more information before the start of the next round.\x3c!-- in the week leading up to the first round. In the meantime, please encourage your friends to sign up as well if you are able to. The more players are involved, the better the experience will be for everyone.--\x3e<br><br><a href='signup.html#register'>&larr; Back to Signup Page</a>",document.title="Success"}}))}}))}}}}}function toggleFallback(e){try{let t=e.getAttribute("c"),r=document.querySelectorAll(`input[c=${t}]`),n={yes:[],maybe:[]};for(let e=0;e<r.length;e++)if(r[e].nextElementSibling.innerHTML.indexOf("*")>-1?n.maybe.push(r[e].checked):n.yes.push(r[e].checked),e==r.length-1){let e={wrap:"fallback_field",for:"fallback_ladder"};!n.yes.includes(!0)&&n.maybe.includes(!0)?byId(e.wrap).classList.remove("h"):byId(e.wrap).classList.add("h")}}catch(e){}try{byId("prefer_team").checked?byId("partner_field").classList.remove("h"):byId("partner_field").classList.add("h")}catch(e){}}function toggleIntConfirm(e){try{let t=e.getAttribute("c"),r=document.querySelectorAll(`input[c=${t}]`),n={yes:[],maybe:[]};for(let e=0;e<r.length;e++)if(r[e].nextElementSibling.innerHTML.indexOf("*")>-1?n.maybe.push(r[e].checked):n.yes.push(r[e].checked),e==r.length-1){let e={wrap:"confirm_intention_field",for:"int_confirm_yes"};n.maybe.includes(!0)?byId(e.wrap).classList.remove("h"):byId(e.wrap).classList.add("h")}}catch(e){}}function toggleFields(e,t){try{let r=document.querySelectorAll(`[name=${e.name}]`);for(let e=0;e<r.length;e++)try{let n;n=t?t.split("/"):r[e].getAttribute("toggle").split("/"),n={wrap:n[0],for:n[1]},r[e].checked?(byId(n.wrap).classList.remove("h"),document.querySelector(`input[c=${n.for}]`).focus()):byId(n.wrap).classList.add("h")}catch(e){}}catch(e){}}function unpulse(){try{document.body.classList.remove("pulse"),byId("submit_signup").disabled=!1}catch(e){}}function saveFormInput(){try{if(location.href.indexOf("&save=no")<0||location.href.indexOf("?save=no")<0){let e=document.querySelectorAll("input[c]"),t={};for(let r=0;r<e.length;r++){let n=e[r].getAttribute("c");if("radio"==e[r].type)e[r].checked&&(t[n]=[...e[r].closest(".wrap").querySelectorAll(`input[c=${n}]`)].indexOf(e[r]));else if("checkbox"==e[r].type){let a=document.querySelectorAll(`input[c=${e[r].getAttribute("c")}]`),l=Array.from(a,(e=>e.checked));t[n]=l}else t[n]=e[r].value;r==e.length-1&&location.hash.indexOf("view-responses")<0&&(t=JSON.stringify(t),localStorage.setItem(brick("$_signupFormInput"+ladderSeason),lsciph(t)))}}}catch(e){}}function viewSignups(e){document.activeElement.style.cursor="progress",ptc("viewable_Signups","*","ladder",e).then((t=>{if(t.error)return alert(t.error.message),!1;!t.error&&(t=t.data);let r,n="",a={true:"s",false:""};t.length>0?(r=`${t.length} signup${a[t.length>1]} so far:`,n=t.map((e=>`<small><i>${e.name}</i></small><br>`)),n=`<div style=''>${n.join("\n")}</div>`):(r="No signups yet...",n=""),window.open("about:blank",rdString(10)).document.write(`<html>\n      <head><title>Signups => ${e} Ladder</title><style>html,body{font-size:1.25rem}</style></head>\n      <body style='background:${getComputedStyle(document.body).background};color:${getComputedStyle(document.body).color};'><h2 style='font-family:cursive;text-decoration:underline'>${e} Ladder</h2><p>${r}</p>${n}</body>\n      </html>`),document.activeElement.style.cursor=""}))}window.onload=()=>{try{getsignups()}catch(e){}try{document.documentElement.style.overflowX="hidden"}catch(e){}try{byId("passct").style.width=`calc(100% + ${getComputedStyle(byId("vbtoggle")).width})`,window.addEventListener("resize",(function(){try{byId("passct").style.width=`calc(100% + ${getComputedStyle(byId("vbtoggle")).width})`}catch(e){}}))}catch(e){}try{document.querySelector("input[c]").focus()}catch(e){}try{if(/^((?!chrome|android).)*safari/i.test(navigator.userAgent)){let e=document.querySelectorAll('input[type="checkbox"],input[type="radio"]');for(let t=0;t<e.length;t++)e[t].classList.add("safari-input")}}catch(e){}try{let e=localStorage.getItem(brick("$_hasRegistered"+ladderSeason)),t=(lsdciph(localStorage.getItem(brick("$_authenticated_user"+ladderSeason))),lsdciph(localStorage.getItem(brick("$_signupFormInput"+ladderSeason))));if(e)if(location.hash.indexOf("view-responses")<0&&location.href.indexOf("invite=")<0)document.body.innerHTML='You have already signed up. Click <a href="?reload=1#view-responses">here</a> to view your responses.';else if(location.href.indexOf("invite=")<0){t||(document.body.innerHTML="Something went wrong ☹️");let e=document.querySelectorAll("input"),r=document.querySelector("input[type=submit]");r.parentNode.removeChild(r);for(let t=0;t<e.length;t++)e[t].setAttribute("disabled","true")}}catch(e){}try{let e=lsdciph(localStorage.getItem(brick("$_signupFormInput"+ladderSeason))),t=Object.keys(e);for(let r=0;r<t.length;r++){let n=e[t[r]],a=document.querySelector(`input[c=${t[r]}]`);if("radio"==a.type)"number"==typeof n&&([...a.closest(".wrap").querySelectorAll(`input[c=${t[r]}]`)][n].checked="true");else if("checkbox"==a.type){let e=document.querySelectorAll(`input[c=${t[r]}]`);for(let a=0;a<e.length;a++){let l=[...e[a].closest(".wrap").querySelectorAll(`input[c=${t[r]}]`)].indexOf(e[a]);l>-1&&1==n[l]&&(e[a].checked=!0)}}else a.value=n}}catch(e){}setTimeout((function(){let e=document.querySelectorAll("input[toggle]");for(let t=0;t<e.length;t++)e[t].checked&&toggleFields(e[t])}),10),setTimeout((function(){toggleFallback(document.querySelector("input[c=ladder]"))}),10),setTimeout((function(){toggleIntConfirm(document.querySelector("input[c=ladder]"))}),10);try{let e=document.querySelectorAll("input");for(let t=0;t<e.length;t++)e[t].addEventListener("blur",(function(){var e=document.querySelector('meta[name="viewport"]');e&&e.setAttribute("content","width=device-width, maximum-scale=1.0, initial-scale=1.0")})),e[t].addEventListener("focus",(function(){var e=document.querySelector('meta[name="viewport"]');e&&e.setAttribute("content","width=device-width, maximum-scale=1.0, initial-scale=1.0")}))}catch(e){}},window.onbeforeunload=function(){},window.onunload=function(){saveFormInput()};const signupsObject={};function getsignups(){ptc("viewable_Signups","*","awx","1").then((e=>{if(e.error)return!1;e=e.data;let t=Object.keys(laddersOffered);for(let r=0;r<t.length;r++)signupsObject[t[r]]=e.filter((e=>e.ladder==t[r]))}))}function showSignups(e){document.activeElement.style.cursor="progress";let t,r=signupsObject[e],n="",a={true:"s",false:""};r.length>0?(t=`${r.length} signup${a[r.length>1]} so far:`,n=r.map((e=>`<small><i>${e.name}</i></small><br>`)),n=`<div style=''>${n.join("\n")}</div>`):(t="No signups yet...",n=""),window.open("about:blank",rdString(10)).document.write(`<html>\n        <head><title>Signups => ${e} Ladder</title><style>html,body{font-size:1.25rem}</style></head>\n        <body style='background:${getComputedStyle(document.body).background};color:${getComputedStyle(document.body).color};'><h2 style='font-family:cursive;text-decoration:underline'>${e} Ladder</h2><p>${t}</p>${n}</body>\n        </html>`),document.activeElement.style.cursor=""}function suggestPartner(e){try{let e=`${document.querySelector("input[c=first_name]").value}${document.querySelector("input[c=last_name]").value}`.replace(/\s/g,"").toLowerCase(),t=signupsObject.Team.filter((t=>t.partner_name.replace(/\s/g,"").toLowerCase()==e)),r=byId("partner_list");r.innerHTML="";for(let e=0;e<t.length;e++){let n=document.createElement("option");n.value=t[e].name,r.appendChild(n)}}catch(e){}}function ischeckable(e){try{return"radio"==e.type||"checkbox"==e.type}catch(e){return!1}}async function register(e){document.createElement("a").href="authorize.html";const{data:t,error:r}=await sb.client.auth.signUp({email:emailx(e.email),password:e.secret_key,options:{data:e}});return{data:t,error:r}}window.addEventListener("keydown",(e=>{}));